-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.addresses
(
    id_address serial NOT NULL,
    address text COLLATE pg_catalog."default",
    CONSTRAINT addresses_pkey PRIMARY KEY (id_address)
);

CREATE TABLE IF NOT EXISTS public.categories
(
    category_id serial NOT NULL,
    category character varying(50) COLLATE pg_catalog."default",
    CONSTRAINT categories_pkey PRIMARY KEY (category_id)
);

CREATE TABLE IF NOT EXISTS public.order_items
(
    id_item serial NOT NULL,
    fk_order_id integer,
    fk_article character varying(10) COLLATE pg_catalog."default",
    quantity integer,
    CONSTRAINT order_items_pkey PRIMARY KEY (id_item)
);

CREATE TABLE IF NOT EXISTS public.orders
(
    id_order serial NOT NULL,
    order_date date,
    delivery_date date,
    fk_address integer,
    fk_user integer,
    code serial NOT NULL,
    fk_status integer,
    CONSTRAINT orders_pkey PRIMARY KEY (id_order)
);

CREATE TABLE IF NOT EXISTS public.producers
(
    producer_id serial NOT NULL,
    producer character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT producers_pkey PRIMARY KEY (producer_id)
);

CREATE TABLE IF NOT EXISTS public.product_names
(
    product_name_id serial NOT NULL,
    product_name character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT product_names_pkey PRIMARY KEY (product_name_id)
);

CREATE TABLE IF NOT EXISTS public.products
(
    article character varying(6) COLLATE pg_catalog."default" NOT NULL,
    fk_product_name integer,
    unit character varying(25) COLLATE pg_catalog."default",
    price integer,
    fk_supplier integer,
    fk_producer integer,
    fk_category integer,
    discount integer,
    amount integer,
    description text COLLATE pg_catalog."default",
    picture text COLLATE pg_catalog."default",
    CONSTRAINT products_pkey PRIMARY KEY (article)
);

CREATE TABLE IF NOT EXISTS public.roles
(
    role_id serial NOT NULL,
    role character varying(55) COLLATE pg_catalog."default",
    CONSTRAINT roles_pkey PRIMARY KEY (role_id)
);

CREATE TABLE IF NOT EXISTS public.statuses
(
    id_status serial NOT NULL,
    status character varying(50) COLLATE pg_catalog."default",
    CONSTRAINT statuses_pkey PRIMARY KEY (id_status)
);

CREATE TABLE IF NOT EXISTS public.suppliers
(
    supplier_id serial NOT NULL,
    supplier character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT suppliers_pkey PRIMARY KEY (supplier_id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    user_id serial NOT NULL,
    fk_role integer,
    full_name character varying(255) COLLATE pg_catalog."default",
    login character varying(255) COLLATE pg_catalog."default",
    password character varying(128) COLLATE pg_catalog."default",
    CONSTRAINT users_pkey PRIMARY KEY (user_id)
);

ALTER TABLE IF EXISTS public.order_items
    ADD CONSTRAINT "1" FOREIGN KEY (fk_order_id)
    REFERENCES public.orders (id_order) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.order_items
    ADD CONSTRAINT "2" FOREIGN KEY (fk_article)
    REFERENCES public.products (article) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT "1" FOREIGN KEY (fk_address)
    REFERENCES public.addresses (id_address) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT "2" FOREIGN KEY (fk_address)
    REFERENCES public.addresses (id_address) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT "3" FOREIGN KEY (fk_status)
    REFERENCES public.statuses (id_status) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT "1" FOREIGN KEY (fk_product_name)
    REFERENCES public.product_names (product_name_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT "2" FOREIGN KEY (fk_supplier)
    REFERENCES public.suppliers (supplier_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT "3" FOREIGN KEY (fk_producer)
    REFERENCES public.producers (producer_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.products
    ADD CONSTRAINT "4" FOREIGN KEY (fk_category)
    REFERENCES public.categories (category_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users
    ADD CONSTRAINT users_fk_role_fkey FOREIGN KEY (fk_role)
    REFERENCES public.roles (role_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;